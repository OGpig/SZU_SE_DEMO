{% load static %}

<!DOCTYPE html>
<!-- saved from url=(0045)https://www.tipdm.org:10010/#/competitionList -->
<html lang="en" class=" ">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no">
    <link rel="icon" href="https://www.tipdm.org:10010/favicon.ico">
    <title>BdRace数睿思 数据挖掘竞赛平台</title>
    <link href="{% static 'css/css_surf_competition/chunk-76f05a57.ea0c22f9.css' %}" rel="prefetch">
    <link href="{% static 'css/css_surf_competition/chunk-773743fd.26ab3fe0.css' %}" rel="prefetch">
    <link href="{% static 'css/css_surf_competition/chunk-common.0e933be9.css' %}" rel="preload" as="style">
    <link href="{% static 'css/css_surf_competition/chunk-vendors.e57a3522.css' %}" rel="preload" as="style">
    <link href="{% static 'css/css_surf_competition/chunk-vendors.e57a3522.css' %}" rel="stylesheet">
    <link href="{% static 'css/css_surf_competition/chunk-common.0e933be9.css' %}" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="{% static 'css/css_surf_competition/chunk-773743fd.26ab3fe0.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/css_surf_competition/chunk-76f05a57.ea0c22f9.css' %}">
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">

</head>

<body>

    <div class="app">
        <div data-v-f7d88a7c="" class="app-wrapper">
            <section data-v-f7d88a7c="" class="header fixed-header">
                <div data-v-f7d88a7c="" class="container">
                    <div class="logo"><a href="/"><img
                                src="{{ MEDIA_URL }}images/home_page/szu_origin.png" 
                                class="user-avatar"></a></div>
                    <div class="menu">
                        <ul>

                        </ul>
                    </div>
                    <div></div>
                </div>
            </section>
            <section data-v-622dd1b6="" data-v-f7d88a7c="" class="app-main">
                <div data-v-622dd1b6="" class="hasBg"><!---->
                    <div class="container">
                        <div class="competitionSort">

                            <div class="competitionSearch el-input el-input--medium el-input-group el-input-group--append el-input--suffix">
                                <input type="text" id="searchInputPage2" autocomplete="off" placeholder="搜索竞赛名称" maxlength="20"
                                    class="el-input__inner">
                                <div class="el-input-group__append">
                                    <button type="button" class="el-button el-button--default el-button--small">
                                        <i class="el-icon-search"></i>
                                    </button>
                                </div>
                            </div>
                            
                            

                            <dl>
                                <dt>状态：</dt>
                                <dd>
                                    <li class="active">全部</li>
                                    <li class="">可报名</li>
                                    <li class="">进行中</li>
                                    <li class="">已结束</li>
                                </dd>
                            </dl>
                            <dl>
                                <dt>分类：</dt>
                                <dd>
                                    <li class="active">全部</li>
                                    <li class="">数据挖掘</li>
                                    <li class="">数据分析</li>
                                    <li class="">数学建模</li>
                                    <li class="">金融数学</li>
                                    <li class="">人工智能</li>
                                    <li class="">大数据应用</li>
                                </dd>
                            </dl>
                        </div>
                        <div class="competitionList">
                            <div class="hd mt30">
                                <ul id="categoryList">
                                    <li class="active" data-tag="all">全部竞赛</li>
                                    <li data-tag="泰迪杯挑战赛">泰迪杯挑战赛</li>
                                    <li data-tag="泰迪杯技能赛">泰迪杯技能赛</li>
                                    <li data-tag="湾区金融数模">湾区金融数模</li>
                                    <li data-tag="华中杯">华中杯</li>
                                    <li data-tag="技能兴鲁">技能兴鲁</li>
                                    <li data-tag="大学生科技节">大学生科技节</li>
                                </ul>
                            </div>
                            <div class="bd mt30">
                                <div class="bandAD"><a><!----><img
                                            src="{{ MEDIA_URL }}images/surf_competition/all_brand.f9249044.jpg"></a>
                                </div>
                                <ul class="competitionListUl" id="competitionList">

                                </ul>
                                <div class="pageSize">
                                    <div class="el-pagination is-background"><button type="button" disabled="disabled"
                                            class="btn-prev"><i class="el-icon el-icon-arrow-left"></i></button>
                                        <ul class="el-pager">
                                            <li class="number active">1</li><!---->
                                            <li class="number">2</li>
                                            <li class="number">3</li>
                                            <li class="number">4</li>
                                            <li class="number">5</li>
                                            <li class="number">6</li>
                                            <li class="el-icon more btn-quicknext el-icon-more"></li>
                                            <li class="number">13</li>
                                        </ul><button type="button" class="btn-next"><i
                                                class="el-icon el-icon-arrow-right"></i></button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </div>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const categoryList = document.getElementById("categoryList");
            const competitionList = document.getElementById("competitionList");
            const searchInput = document.querySelector(".competitionSearch input");
            const searchButton = document.querySelector(".competitionSearch button");

            searchButton.addEventListener("click", function () {
                const searchKeyword = searchInput.value.trim();

                // 向后端发送请求
                fetch(`/surf_competition/search_competition/?search=${encodeURIComponent(searchKeyword)}`)
                    .then((response) => response.json())
                    .then((data) => {
                        console.log("Received Data:", data);
                        // 清空当前比赛列表
                        competitionList.innerHTML = "";

                        // 更新比赛列表
                        if (data.length > 0) {
                            data.forEach((item) => {
                                const listItem = `
                            <li class="status status-off">
                                <div class="img">
                                    <img src="{{ MEDIA_URL }}images/surf_competition/2eb6e05cd2d74ed8bc312240461f65a2.png">
                                </div>
                                <div class="content">
                                    <div class="tit">
                                        <h1>${item.name}</h1>
                                        <span class="el-tag el-tag--small el-tag--light">${item.category}</span>
                                    </div>
                                    <div class="intro">
                                        <p>品牌：${item.brand}</p>
                                        <p>组织单位：${item.organization}</p>
                                    </div>
                                    <div class="info">
                                        <span class="bonus">
                                            <i class="el-icon-trophy"></i> <font>奖金</font>
                                            <em>CNY ¥${item.bonus}</em>
                                        </span>
                                        <span class="dateTime">
                                            <i class="el-icon-time"></i> <font>时间：</font>${item.time}
                                        </span>
                                    </div>
                                </div>
                            </li>
                        `;
                                competitionList.insertAdjacentHTML("beforeend", listItem);
                            });
                        } else {
                            competitionList.innerHTML = "<li>暂无相关比赛</li>";
                        }
                    })
                    .catch((error) => {
                        console.error("Error fetching competition data:", error);
                    });
            });
            // 定义函数：获取竞赛数据并更新列表
            function fetchAndRenderCompetitions(tag = "all") {
                // 向后端发送请求
                fetch(`/surf_competition/filter_competition/?category=${tag}`)
                    .then((response) => response.json())
                    .then((data) => {
                        // 清空当前比赛列表
                        competitionList.innerHTML = "";

                        // 更新比赛列表
                        if (data.length > 0) {
                            data.forEach((item) => {
                                const listItem = `
                            <li class="status status-off">
                                <div class="img">
                                    <img src="{{ MEDIA_URL }}images/surf_competition/2eb6e05cd2d74ed8bc312240461f65a2.png">
                                </div>
                                <div class="content">
                                    <div class="tit">
                                        <h1>
                                            <a href="/surf_competition/competition_detail/?id=${item.id}" target="_blank">
                                            ${item.name}
                                        </a>
                                        </h1>
                                        <span class="el-tag el-tag--small el-tag--light">${item.category}</span>
                                    </div>
                                    <div class="intro">
                                        <p>品牌：${item.brand}</p>
                                        <p>组织单位：${item.organization}</p>
                                    </div>
                                    <div class="info">
                                        <span class="bonus">
                                            <i class="el-icon-trophy"></i> <font>奖金</font>
                                            <em>CNY ¥${item.bonus}</em>
                                        </span>
                                        <span class="dateTime">
                                            <i class="el-icon-time"></i> <font>时间：</font>${item.time}
                                        </span>
                                    </div>
                                </div>
                            </li>
                        `;
                                competitionList.insertAdjacentHTML("beforeend", listItem);
                            });
                        } else {
                            competitionList.innerHTML = "<li>暂无相关比赛</li>";
                        }
                    })
                    .catch((error) => {
                        console.error("Error fetching competition data:", error);
                        competitionList.innerHTML = "<li>加载比赛数据失败，请稍后重试。</li>";
                    });
            }

            // 默认显示全部竞赛
            fetchAndRenderCompetitions();

            // 点击事件监听：筛选竞赛
            categoryList.addEventListener("click", function (e) {
                if (e.target.tagName === "LI") {
                    // 获取点击的类别标签
                    const tag = e.target.getAttribute("data-tag");

                    // 更新选中样式
                    document.querySelectorAll("#categoryList li").forEach((li) => {
                        li.classList.remove("active");
                    });
                    e.target.classList.add("active");

                    // 获取并渲染筛选数据
                    fetchAndRenderCompetitions(tag);
                }
            });
        });
    </script>
    <script>
        // 获取URL中的search参数
        const params = new URLSearchParams(window.location.search);
        const searchQuery = params.get('search');
        if (searchQuery) {
            // 自动填入搜索框
            document.getElementById('searchInputPage2').value = decodeURIComponent(searchQuery);
        }
    </script>
</body>

</html>